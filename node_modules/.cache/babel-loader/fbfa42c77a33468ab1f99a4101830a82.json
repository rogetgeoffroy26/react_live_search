{"ast":null,"code":"Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getSuggestionQuery = exports.isPropertyDefined = exports.handleResponseMSearch = exports.handleResponse = exports.handleError = exports.getQuerySuggestionsId = exports.isComponentActive = exports.handleTransformResponse = undefined;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nexports.executeQueryListener = executeQueryListener;\n\nvar _constants = require('../../lib/utils/constants');\n\nvar _misc = require('./misc');\n\nvar _hits = require('./hits');\n\nvar _transform = require('../../lib/utils/transform');\n\nvar handleTransformResponse = exports.handleTransformResponse = function handleTransformResponse() {\n  var res = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n  var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var component = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n\n  if (config.transformResponse && typeof config.transformResponse === 'function') {\n    return config.transformResponse(res, component);\n  }\n\n  return new Promise(function (resolve) {\n    return resolve(res);\n  });\n};\n\nvar isComponentActive = exports.isComponentActive = function isComponentActive() {\n  var getState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function () {};\n  var componentId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n  var _getState = getState(),\n      components = _getState.components;\n\n  if (components.includes(componentId)) {\n    return true;\n  }\n\n  return false;\n};\n\nvar getQuerySuggestionsId = exports.getQuerySuggestionsId = function getQuerySuggestionsId() {\n  var componentId = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return componentId + '__suggestions';\n};\n\nvar handleError = exports.handleError = function handleError() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref$orderOfQueries = _ref.orderOfQueries,\n      orderOfQueries = _ref$orderOfQueries === undefined ? [] : _ref$orderOfQueries,\n      _ref$error = _ref.error,\n      error = _ref$error === undefined ? null : _ref$error;\n\n  var getState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n  var dispatch = arguments[2];\n\n  var _getState2 = getState(),\n      queryListener = _getState2.queryListener;\n\n  try {\n    console.error(JSON.stringify(error));\n  } catch (e) {\n    console.error(error);\n  }\n\n  orderOfQueries.forEach(function (component) {\n    if (isComponentActive(getState, component)) {\n      if (queryListener[component] && queryListener[component].onError) {\n        queryListener[component].onError(error);\n      }\n\n      dispatch((0, _misc.setError)(component, error));\n      dispatch((0, _misc.setLoading)(component, false));\n    }\n  });\n};\n\nvar handleResponse = exports.handleResponse = function handleResponse() {\n  var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      res = _ref2.res,\n      _ref2$querySuggestion = _ref2.querySuggestions,\n      querySuggestions = _ref2$querySuggestion === undefined ? {} : _ref2$querySuggestion,\n      _ref2$orderOfQueries = _ref2.orderOfQueries,\n      orderOfQueries = _ref2$orderOfQueries === undefined ? [] : _ref2$orderOfQueries,\n      _ref2$appendToHits = _ref2.appendToHits,\n      appendToHits = _ref2$appendToHits === undefined ? false : _ref2$appendToHits,\n      _ref2$appendToAggs = _ref2.appendToAggs,\n      appendToAggs = _ref2$appendToAggs === undefined ? false : _ref2$appendToAggs,\n      _ref2$isInternalCompo = _ref2.isInternalComponent,\n      isInternalComponent = _ref2$isInternalCompo === undefined ? false : _ref2$isInternalCompo,\n      _ref2$componentType = _ref2.componentType,\n      componentType = _ref2$componentType === undefined ? '' : _ref2$componentType,\n      _ref2$componentId = _ref2.componentId,\n      componentId = _ref2$componentId === undefined ? '' : _ref2$componentId;\n\n  var getState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n  var dispatch = arguments[2];\n\n  var _getState3 = getState(),\n      config = _getState3.config,\n      internalValues = _getState3.internalValues;\n\n  var suggestionsComponents = [_constants.componentTypes.dataSearch, _constants.componentTypes.categorySearch];\n  var isSuggestionsQuery = isInternalComponent && suggestionsComponents.indexOf(componentType) !== -1;\n  var searchId = res._headers ? res._headers.get('X-Search-Id') : null;\n\n  if (searchId) {\n    if (isSuggestionsQuery) {\n      dispatch((0, _misc.setSuggestionsSearchId)(searchId));\n    } else {\n      dispatch((0, _misc.setSearchId)(searchId));\n    }\n  }\n\n  orderOfQueries.forEach(function (component) {\n    if (isComponentActive(getState, component)) {\n      if (res.settings) {\n        dispatch((0, _misc.setAppliedSettings)(res.settings, component));\n      }\n\n      handleTransformResponse(res[component], config, component).then(function (response) {\n        var querySuggestion = querySuggestions[getQuerySuggestionsId(componentId)];\n\n        if (response) {\n          var _getState4 = getState(),\n              timestamp = _getState4.timestamp;\n\n          if (timestamp[component] === undefined || timestamp[component] < res._timestamp) {\n            var promotedResults = response.promoted;\n\n            if (promotedResults) {\n              var parsedPromotedResults = promotedResults.map(function (promoted) {\n                return _extends({}, promoted.doc, {\n                  _position: promoted.position\n                });\n              });\n              dispatch((0, _misc.setPromotedResults)(parsedPromotedResults, component));\n            } else {\n              dispatch((0, _misc.setPromotedResults)([], component));\n            }\n\n            dispatch((0, _misc.setRawData)(component, response));\n            dispatch((0, _misc.setCustomData)(response.customData, component));\n\n            if (response.hits) {\n              dispatch((0, _misc.setTimestamp)(component, res._timestamp));\n              dispatch((0, _hits.updateHits)(component, response.hits, response.took, response.hits && response.hits.hidden, appendToHits));\n              var internalComponentID = (0, _transform.getInternalComponentID)(component);\n\n              if (internalValues[internalComponentID]) {\n                dispatch((0, _hits.saveQueryToHits)(component, internalValues[internalComponentID].value));\n              }\n\n              dispatch((0, _misc.setLoading)(component, false));\n            }\n\n            if (response.aggregations) {\n              dispatch((0, _hits.updateAggs)(component, response.aggregations, appendToAggs));\n              dispatch((0, _hits.updateCompositeAggs)(component, response.aggregations, appendToAggs));\n            }\n\n            if (isSuggestionsQuery) {\n              dispatch((0, _misc.setQuerySuggestions)(querySuggestion && querySuggestion.hits && querySuggestion.hits.hits, component));\n            }\n          }\n        }\n      }).catch(function (err) {\n        handleError({\n          orderOfQueries: orderOfQueries,\n          error: err\n        }, getState, dispatch);\n      });\n    }\n  });\n};\n\nvar handleResponseMSearch = exports.handleResponseMSearch = function handleResponseMSearch(_ref3) {\n  var _ref3$res = _ref3.res,\n      res = _ref3$res === undefined ? {} : _ref3$res,\n      _ref3$isSuggestionsQu = _ref3.isSuggestionsQuery,\n      isSuggestionsQuery = _ref3$isSuggestionsQu === undefined ? false : _ref3$isSuggestionsQu,\n      _ref3$orderOfQueries = _ref3.orderOfQueries,\n      orderOfQueries = _ref3$orderOfQueries === undefined ? [] : _ref3$orderOfQueries,\n      _ref3$appendToHits = _ref3.appendToHits,\n      appendToHits = _ref3$appendToHits === undefined ? false : _ref3$appendToHits,\n      _ref3$appendToAggs = _ref3.appendToAggs,\n      appendToAggs = _ref3$appendToAggs === undefined ? false : _ref3$appendToAggs;\n  var getState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n  var dispatch = arguments[2];\n  var searchId = res._headers ? res._headers.get('X-Search-Id') : null;\n\n  if (searchId) {\n    if (isSuggestionsQuery) {\n      dispatch((0, _misc.setSuggestionsSearchId)(searchId));\n    } else {\n      dispatch((0, _misc.setSearchId)(searchId));\n    }\n  }\n\n  orderOfQueries.forEach(function (component, index) {\n    if (isComponentActive(getState, component)) {\n      var transformResponse = res;\n\n      if (res && Array.isArray(res.responses) && res.responses[index]) {\n        transformResponse = res.responses[index];\n      }\n\n      var _getState5 = getState(),\n          config = _getState5.config,\n          internalValues = _getState5.internalValues;\n\n      handleTransformResponse(transformResponse, config, component).then(function (response) {\n        var _getState6 = getState(),\n            timestamp = _getState6.timestamp;\n\n        if (timestamp[component] === undefined || timestamp[component] < res._timestamp) {\n          dispatch((0, _misc.setRawData)(component, response));\n          var promotedResults = response.promoted || res.promoted;\n\n          if (promotedResults) {\n            dispatch((0, _misc.setPromotedResults)(promotedResults, component));\n          } else {\n            dispatch((0, _misc.setPromotedResults)([], component));\n          }\n\n          if (response.hits) {\n            dispatch((0, _misc.setTimestamp)(component, res._timestamp));\n            dispatch((0, _hits.updateHits)(component, response.hits, response.took, response.hits && response.hits.hidden, appendToHits));\n            dispatch((0, _misc.setLoading)(component, false));\n            var internalComponentID = (0, _transform.getInternalComponentID)(component);\n\n            if (internalValues[internalComponentID]) {\n              dispatch((0, _hits.saveQueryToHits)(component, internalValues[internalComponentID].value));\n            }\n          }\n\n          if (response.aggregations) {\n            dispatch((0, _hits.updateAggs)(component, response.aggregations, appendToAggs));\n            dispatch((0, _hits.updateCompositeAggs)(component, response.aggregations, appendToAggs));\n          }\n        }\n      }).catch(function (err) {\n        handleError({\n          orderOfQueries: orderOfQueries,\n          error: err\n        }, getState, dispatch);\n      });\n    }\n  });\n};\n\nvar isPropertyDefined = exports.isPropertyDefined = function isPropertyDefined(property) {\n  return property !== undefined && property !== null;\n};\n\nvar getSuggestionQuery = exports.getSuggestionQuery = function getSuggestionQuery() {\n  var getState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function () {};\n  var componentId = arguments[1];\n\n  var _getState7 = getState(),\n      props = _getState7.props,\n      internalValues = _getState7.internalValues;\n\n  var internalValue = internalValues[componentId];\n  var componentProps = props[componentId];\n  return [{\n    id: getQuerySuggestionsId(componentId),\n    dataField: ['key', 'key.autosuggest', 'key.search'],\n    searchOperators: componentProps && componentProps.searchOperators || null,\n    size: 5,\n    value: internalValue && internalValue.value,\n    enableSynonyms: componentProps && componentProps.enableSynonyms || null,\n    defaultQuery: {\n      sort: [{\n        count: {\n          order: 'desc'\n        }\n      }]\n    }\n  }];\n};\n\nfunction executeQueryListener(listener, oldQuery, newQuery) {\n  if (listener && listener.onQueryChange) {\n    listener.onQueryChange(oldQuery, newQuery);\n  }\n}","map":{"version":3,"sources":["/Users/rogetgeoffroy/Desktop/Folders/react_js_folder/react-live-search-app/live-search/node_modules/@appbaseio/reactivecore/lib/actions/utils.js"],"names":["Object","defineProperty","exports","value","getSuggestionQuery","isPropertyDefined","handleResponseMSearch","handleResponse","handleError","getQuerySuggestionsId","isComponentActive","handleTransformResponse","undefined","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","executeQueryListener","_constants","require","_misc","_hits","_transform","res","config","component","transformResponse","Promise","resolve","getState","componentId","_getState","components","includes","_ref","_ref$orderOfQueries","orderOfQueries","_ref$error","error","dispatch","_getState2","queryListener","console","JSON","stringify","e","forEach","onError","setError","setLoading","_ref2","_ref2$querySuggestion","querySuggestions","_ref2$orderOfQueries","_ref2$appendToHits","appendToHits","_ref2$appendToAggs","appendToAggs","_ref2$isInternalCompo","isInternalComponent","_ref2$componentType","componentType","_ref2$componentId","_getState3","internalValues","suggestionsComponents","componentTypes","dataSearch","categorySearch","isSuggestionsQuery","indexOf","searchId","_headers","get","setSuggestionsSearchId","setSearchId","settings","setAppliedSettings","then","response","querySuggestion","_getState4","timestamp","_timestamp","promotedResults","promoted","parsedPromotedResults","map","doc","_position","position","setPromotedResults","setRawData","setCustomData","customData","hits","setTimestamp","updateHits","took","hidden","internalComponentID","getInternalComponentID","saveQueryToHits","aggregations","updateAggs","updateCompositeAggs","setQuerySuggestions","catch","err","_ref3","_ref3$res","_ref3$isSuggestionsQu","_ref3$orderOfQueries","_ref3$appendToHits","_ref3$appendToAggs","index","Array","isArray","responses","_getState5","_getState6","property","_getState7","props","internalValue","componentProps","id","dataField","searchOperators","size","enableSynonyms","defaultQuery","sort","count","order","listener","oldQuery","newQuery","onQueryChange"],"mappings":"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","sourcesContent":["Object.defineProperty(exports,\"__esModule\",{value:true});exports.getSuggestionQuery=exports.isPropertyDefined=exports.handleResponseMSearch=exports.handleResponse=exports.handleError=exports.getQuerySuggestionsId=exports.isComponentActive=exports.handleTransformResponse=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};exports.executeQueryListener=executeQueryListener;var _constants=require('../../lib/utils/constants');var _misc=require('./misc');var _hits=require('./hits');var _transform=require('../../lib/utils/transform');var handleTransformResponse=exports.handleTransformResponse=function handleTransformResponse(){var res=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var config=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var component=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';if(config.transformResponse&&typeof config.transformResponse==='function'){return config.transformResponse(res,component);}return new Promise(function(resolve){return resolve(res);});};var isComponentActive=exports.isComponentActive=function isComponentActive(){var getState=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};var componentId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';var _getState=getState(),components=_getState.components;if(components.includes(componentId)){return true;}return false;};var getQuerySuggestionsId=exports.getQuerySuggestionsId=function getQuerySuggestionsId(){var componentId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return componentId+'__suggestions';};var handleError=exports.handleError=function handleError(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$orderOfQueries=_ref.orderOfQueries,orderOfQueries=_ref$orderOfQueries===undefined?[]:_ref$orderOfQueries,_ref$error=_ref.error,error=_ref$error===undefined?null:_ref$error;var getState=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var dispatch=arguments[2];var _getState2=getState(),queryListener=_getState2.queryListener;try{console.error(JSON.stringify(error));}catch(e){console.error(error);}orderOfQueries.forEach(function(component){if(isComponentActive(getState,component)){if(queryListener[component]&&queryListener[component].onError){queryListener[component].onError(error);}dispatch((0,_misc.setError)(component,error));dispatch((0,_misc.setLoading)(component,false));}});};var handleResponse=exports.handleResponse=function handleResponse(){var _ref2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},res=_ref2.res,_ref2$querySuggestion=_ref2.querySuggestions,querySuggestions=_ref2$querySuggestion===undefined?{}:_ref2$querySuggestion,_ref2$orderOfQueries=_ref2.orderOfQueries,orderOfQueries=_ref2$orderOfQueries===undefined?[]:_ref2$orderOfQueries,_ref2$appendToHits=_ref2.appendToHits,appendToHits=_ref2$appendToHits===undefined?false:_ref2$appendToHits,_ref2$appendToAggs=_ref2.appendToAggs,appendToAggs=_ref2$appendToAggs===undefined?false:_ref2$appendToAggs,_ref2$isInternalCompo=_ref2.isInternalComponent,isInternalComponent=_ref2$isInternalCompo===undefined?false:_ref2$isInternalCompo,_ref2$componentType=_ref2.componentType,componentType=_ref2$componentType===undefined?'':_ref2$componentType,_ref2$componentId=_ref2.componentId,componentId=_ref2$componentId===undefined?'':_ref2$componentId;var getState=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var dispatch=arguments[2];var _getState3=getState(),config=_getState3.config,internalValues=_getState3.internalValues;var suggestionsComponents=[_constants.componentTypes.dataSearch,_constants.componentTypes.categorySearch];var isSuggestionsQuery=isInternalComponent&&suggestionsComponents.indexOf(componentType)!==-1;var searchId=res._headers?res._headers.get('X-Search-Id'):null;if(searchId){if(isSuggestionsQuery){dispatch((0,_misc.setSuggestionsSearchId)(searchId));}else{dispatch((0,_misc.setSearchId)(searchId));}}orderOfQueries.forEach(function(component){if(isComponentActive(getState,component)){if(res.settings){dispatch((0,_misc.setAppliedSettings)(res.settings,component));}handleTransformResponse(res[component],config,component).then(function(response){var querySuggestion=querySuggestions[getQuerySuggestionsId(componentId)];if(response){var _getState4=getState(),timestamp=_getState4.timestamp;if(timestamp[component]===undefined||timestamp[component]<res._timestamp){var promotedResults=response.promoted;if(promotedResults){var parsedPromotedResults=promotedResults.map(function(promoted){return _extends({},promoted.doc,{_position:promoted.position});});dispatch((0,_misc.setPromotedResults)(parsedPromotedResults,component));}else{dispatch((0,_misc.setPromotedResults)([],component));}dispatch((0,_misc.setRawData)(component,response));dispatch((0,_misc.setCustomData)(response.customData,component));if(response.hits){dispatch((0,_misc.setTimestamp)(component,res._timestamp));dispatch((0,_hits.updateHits)(component,response.hits,response.took,response.hits&&response.hits.hidden,appendToHits));var internalComponentID=(0,_transform.getInternalComponentID)(component);if(internalValues[internalComponentID]){dispatch((0,_hits.saveQueryToHits)(component,internalValues[internalComponentID].value));}dispatch((0,_misc.setLoading)(component,false));}if(response.aggregations){dispatch((0,_hits.updateAggs)(component,response.aggregations,appendToAggs));dispatch((0,_hits.updateCompositeAggs)(component,response.aggregations,appendToAggs));}if(isSuggestionsQuery){dispatch((0,_misc.setQuerySuggestions)(querySuggestion&&querySuggestion.hits&&querySuggestion.hits.hits,component));}}}}).catch(function(err){handleError({orderOfQueries:orderOfQueries,error:err},getState,dispatch);});}});};var handleResponseMSearch=exports.handleResponseMSearch=function handleResponseMSearch(_ref3){var _ref3$res=_ref3.res,res=_ref3$res===undefined?{}:_ref3$res,_ref3$isSuggestionsQu=_ref3.isSuggestionsQuery,isSuggestionsQuery=_ref3$isSuggestionsQu===undefined?false:_ref3$isSuggestionsQu,_ref3$orderOfQueries=_ref3.orderOfQueries,orderOfQueries=_ref3$orderOfQueries===undefined?[]:_ref3$orderOfQueries,_ref3$appendToHits=_ref3.appendToHits,appendToHits=_ref3$appendToHits===undefined?false:_ref3$appendToHits,_ref3$appendToAggs=_ref3.appendToAggs,appendToAggs=_ref3$appendToAggs===undefined?false:_ref3$appendToAggs;var getState=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var dispatch=arguments[2];var searchId=res._headers?res._headers.get('X-Search-Id'):null;if(searchId){if(isSuggestionsQuery){dispatch((0,_misc.setSuggestionsSearchId)(searchId));}else{dispatch((0,_misc.setSearchId)(searchId));}}orderOfQueries.forEach(function(component,index){if(isComponentActive(getState,component)){var transformResponse=res;if(res&&Array.isArray(res.responses)&&res.responses[index]){transformResponse=res.responses[index];}var _getState5=getState(),config=_getState5.config,internalValues=_getState5.internalValues;handleTransformResponse(transformResponse,config,component).then(function(response){var _getState6=getState(),timestamp=_getState6.timestamp;if(timestamp[component]===undefined||timestamp[component]<res._timestamp){dispatch((0,_misc.setRawData)(component,response));var promotedResults=response.promoted||res.promoted;if(promotedResults){dispatch((0,_misc.setPromotedResults)(promotedResults,component));}else{dispatch((0,_misc.setPromotedResults)([],component));}if(response.hits){dispatch((0,_misc.setTimestamp)(component,res._timestamp));dispatch((0,_hits.updateHits)(component,response.hits,response.took,response.hits&&response.hits.hidden,appendToHits));dispatch((0,_misc.setLoading)(component,false));var internalComponentID=(0,_transform.getInternalComponentID)(component);if(internalValues[internalComponentID]){dispatch((0,_hits.saveQueryToHits)(component,internalValues[internalComponentID].value));}}if(response.aggregations){dispatch((0,_hits.updateAggs)(component,response.aggregations,appendToAggs));dispatch((0,_hits.updateCompositeAggs)(component,response.aggregations,appendToAggs));}}}).catch(function(err){handleError({orderOfQueries:orderOfQueries,error:err},getState,dispatch);});}});};var isPropertyDefined=exports.isPropertyDefined=function isPropertyDefined(property){return property!==undefined&&property!==null;};var getSuggestionQuery=exports.getSuggestionQuery=function getSuggestionQuery(){var getState=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};var componentId=arguments[1];var _getState7=getState(),props=_getState7.props,internalValues=_getState7.internalValues;var internalValue=internalValues[componentId];var componentProps=props[componentId];return[{id:getQuerySuggestionsId(componentId),dataField:['key','key.autosuggest','key.search'],searchOperators:componentProps&&componentProps.searchOperators||null,size:5,value:internalValue&&internalValue.value,enableSynonyms:componentProps&&componentProps.enableSynonyms||null,defaultQuery:{sort:[{count:{order:'desc'}}]}}];};function executeQueryListener(listener,oldQuery,newQuery){if(listener&&listener.onQueryChange){listener.onQueryChange(oldQuery,newQuery);}}"]},"metadata":{},"sourceType":"script"}