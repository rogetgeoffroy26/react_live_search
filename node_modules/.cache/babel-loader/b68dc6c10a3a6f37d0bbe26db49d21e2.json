{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _actions = require('@appbaseio/reactivecore/lib/actions');\n\nvar _helper = require('@appbaseio/reactivecore/lib/utils/helper');\n\nvar _types = require('@appbaseio/reactivecore/lib/utils/types');\n\nvar _types2 = _interopRequireDefault(_types);\n\nvar _transform = require('@appbaseio/reactivecore/lib/utils/transform');\n\nvar _constants = require('@appbaseio/reactivecore/lib/utils/constants');\n\nvar _utils = require('../../utils');\n\nvar _ComponentWrapper = require('../basic/ComponentWrapper');\n\nvar _ComponentWrapper2 = _interopRequireDefault(_ComponentWrapper);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar ReactiveComponent = function (_Component) {\n  _inherits(ReactiveComponent, _Component);\n\n  function ReactiveComponent(props) {\n    _classCallCheck(this, ReactiveComponent);\n\n    var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n    _this.getAggsQuery = function () {\n      if (_this.props.aggregationField) {\n        return (0, _helper.getCompositeAggsQuery)({}, _this.props, null, true);\n      }\n\n      return {};\n    };\n\n    _this.internalComponent = null;\n    _this.defaultQuery = null;\n\n    _this.setQuery = function (data) {\n      if (!data) {\n        console.error('setQuery accepts the arguments of shape { query, options, value }.');\n        return;\n      }\n\n      var options = data.options,\n          obj = _objectWithoutProperties(data, ['options']);\n\n      if (options) {\n        props.setQueryOptions(props.componentId, _extends({}, options, _this.getAggsQuery()), false);\n      }\n\n      var queryToBeSet = obj.query; // when enableAppbase is true, Backend throws error because of repeated query in request body\n\n      if (obj && obj.query && obj.query.query) {\n        queryToBeSet = obj.query.query;\n      } // Update customQuery field for RS API\n\n\n      if (obj && obj.query || options) {\n        var customQuery = _extends({}, options);\n\n        if (obj && obj.query) {\n          customQuery.query = queryToBeSet;\n        }\n\n        props.setCustomQuery(props.componentId, customQuery);\n      }\n\n      _this.props.updateQuery(_extends({}, obj, {\n        query: queryToBeSet,\n        componentId: props.componentId,\n        label: props.filterLabel,\n        showFilter: props.showFilter,\n        URLParams: props.URLParams\n      }));\n    };\n\n    if (props.defaultQuery) {\n      _this.internalComponent = (0, _transform.getInternalComponentID)(props.componentId);\n    } // Set custom and default queries in store\n\n\n    (0, _helper.updateCustomQuery)(props.componentId, props, undefined);\n    (0, _helper.updateDefaultQuery)(props.componentId, props, undefined);\n\n    if (_this.internalComponent && props.defaultQuery) {\n      _this.defaultQuery = props.defaultQuery();\n\n      var _ref = _this.defaultQuery || {},\n          query = _ref.query;\n\n      var defaultQueryOptions = _this.defaultQuery ? (0, _helper.getOptionsFromQuery)(_this.defaultQuery) : null;\n\n      if (defaultQueryOptions) {\n        props.setQueryOptions(_this.internalComponent, _extends({}, defaultQueryOptions, _this.getAggsQuery()), false);\n      } else _this.props.setQueryOptions(_this.internalComponent, _this.getAggsQuery());\n\n      props.updateQuery({\n        componentId: _this.internalComponent,\n        query: query || null\n      });\n    }\n\n    return _this;\n  }\n\n  ReactiveComponent.prototype.componentDidMount = function componentDidMount() {\n    var _props = this.props,\n        customQuery = _props.customQuery,\n        selectedValue = _props.selectedValue,\n        value = _props.value,\n        defaultValue = _props.defaultValue,\n        componentId = _props.componentId,\n        filterLabel = _props.filterLabel,\n        showFilter = _props.showFilter,\n        URLParams = _props.URLParams;\n    var initialValue = selectedValue || value || defaultValue || null;\n\n    if (customQuery) {\n      var calcCustomQuery = customQuery(this.props);\n\n      var _ref2 = calcCustomQuery || {},\n          query = _ref2.query;\n\n      var customQueryOptions = calcCustomQuery ? (0, _helper.getOptionsFromQuery)(calcCustomQuery) : null;\n\n      if (customQueryOptions) {\n        this.props.setQueryOptions(componentId, _extends({}, customQueryOptions, this.getAggsQuery()), false);\n      } else this.props.setQueryOptions(componentId, this.getAggsQuery(), false);\n\n      this.props.updateQuery({\n        componentId: componentId,\n        query: query,\n        value: initialValue,\n        label: filterLabel,\n        showFilter: showFilter,\n        URLParams: URLParams\n      });\n    }\n  };\n\n  ReactiveComponent.prototype.componentDidUpdate = function componentDidUpdate(prevProps) {\n    var _this2 = this; // only consider hits and defaultQuery when customQuery is absent\n\n\n    if (this.props.onData) {\n      (0, _helper.checkSomePropChange)(this.props, prevProps, ['hits', 'aggregations', 'promotedResults', 'total', 'time', 'hidden'], function () {\n        _this2.props.onData(_this2.getData());\n      });\n    }\n\n    (0, _helper.checkPropChange)(this.props.selectedValue, prevProps.selectedValue, function () {\n      /*\n      \tReset query when SelectedFilters are clicked. Note: `selectedValue` becomes null.\n      */\n      if (_this2.props.selectedValue === null) {\n        _this2.props.updateQuery({\n          componentId: _this2.props.componentId,\n          query: null\n        });\n      }\n    });\n\n    if (this.props.defaultQuery && !(0, _helper.isEqual)(this.props.defaultQuery(), this.defaultQuery)) {\n      this.defaultQuery = this.props.defaultQuery();\n\n      var _ref3 = this.defaultQuery || {},\n          query = _ref3.query,\n          queryOptions = _objectWithoutProperties(_ref3, ['query']);\n\n      if (queryOptions) {\n        this.props.setQueryOptions(this.internalComponent, _extends({}, queryOptions, this.getAggsQuery()), false);\n      } else this.props.setQueryOptions(this.internalComponent, this.getAggsQuery(), false);\n\n      (0, _helper.updateDefaultQuery)(this.props.componentId, this.props, undefined);\n      this.props.updateQuery({\n        componentId: this.internalComponent,\n        query: query || null\n      });\n    }\n\n    if (this.props.customQuery && !(0, _helper.isEqual)(this.props.customQuery(this.props), prevProps.customQuery(this.props))) {\n      var _ref4 = this.props.customQuery(this.props) || {},\n          _query = _ref4.query,\n          _queryOptions = _objectWithoutProperties(_ref4, ['query']);\n\n      if (_queryOptions) {\n        this.props.setQueryOptions(this.props.componentId, _extends({}, _queryOptions, this.getAggsQuery()), false);\n      } else this.props.setQueryOptions(this.props.componentId, this.getAggsQuery(), false);\n\n      (0, _helper.updateCustomQuery)(this.props.componentId, this.props, undefined);\n      this.props.updateQuery({\n        componentId: this.props.componentId,\n        query: _query || null\n      });\n    }\n  };\n\n  ReactiveComponent.prototype.getData = function getData() {\n    var _props2 = this.props,\n        hits = _props2.hits,\n        aggregations = _props2.aggregations,\n        aggregationData = _props2.aggregationData,\n        promotedResults = _props2.promotedResults,\n        rawData = _props2.rawData;\n    var filteredResults = (0, _helper.parseHits)(hits);\n\n    if (promotedResults.length) {\n      var ids = promotedResults.map(function (item) {\n        return item._id;\n      }).filter(Boolean);\n\n      if (ids) {\n        filteredResults = filteredResults.filter(function (item) {\n          return !ids.includes(item._id);\n        });\n      }\n\n      filteredResults = [].concat(promotedResults, filteredResults);\n    }\n\n    return {\n      data: filteredResults,\n      promotedData: promotedResults,\n      aggregationData: aggregationData || [],\n      rawData: rawData,\n      aggregations: aggregations,\n      resultStats: this.stats\n    };\n  };\n\n  ReactiveComponent.prototype.getComponent = function getComponent() {\n    var _props3 = this.props,\n        error = _props3.error,\n        isLoading = _props3.isLoading,\n        selectedValue = _props3.selectedValue;\n\n    var data = _extends({\n      error: error,\n      loading: isLoading\n    }, this.getData(), {\n      value: selectedValue,\n      setQuery: this.setQuery\n    });\n\n    return (0, _utils.getComponent)(data, this.props);\n  };\n\n  ReactiveComponent.prototype.render = function render() {\n    if ((0, _utils.hasCustomRenderer)(this.props)) {\n      return this.getComponent();\n    }\n\n    return null;\n  };\n\n  _createClass(ReactiveComponent, [{\n    key: 'stats',\n    get: function get() {\n      return (0, _helper.getResultStats)(this.props);\n    }\n  }]);\n\n  return ReactiveComponent;\n}(_react.Component);\n\nReactiveComponent.defaultProps = {\n  showFilter: true,\n  URLParams: false,\n  size: 20\n};\nReactiveComponent.propTypes = {\n  error: _types2.default.title,\n  setQueryOptions: _types2.default.funcRequired,\n  updateQuery: _types2.default.funcRequired,\n  aggregationField: _types2.default.string,\n  size: _types2.default.number,\n  aggregations: _types2.default.selectedValues,\n  aggregationData: _types2.default.aggregationData,\n  hits: _types2.default.data,\n  rawData: _types2.default.rawData,\n  promotedResults: _types2.default.hits,\n  isLoading: _types2.default.bool,\n  selectedValue: _types2.default.selectedValue,\n  setCustomQuery: _types2.default.funcRequired,\n  // component props\n  children: _types2.default.func,\n  componentId: _types2.default.stringRequired,\n  defaultQuery: _types2.default.func,\n  customQuery: _types2.default.func,\n  defaultValue: _types2.default.any,\n  // eslint-disable-line\n  value: _types2.default.any,\n  // eslint-disable-line\n  filterLabel: _types2.default.string,\n  onQueryChange: _types2.default.func,\n  onError: _types2.default.func,\n  react: _types2.default.react,\n  render: _types2.default.func,\n  showFilter: _types2.default.bool,\n  URLParams: _types2.default.bool,\n  onData: _types2.default.func\n}; // Add componentType for SSR\n\nReactiveComponent.componentType = _constants.componentTypes.reactiveComponent;\n\nvar mapStateToProps = function mapStateToProps(state, props) {\n  return {\n    aggregations: state.aggregations[props.componentId] && state.aggregations[props.componentId] || null,\n    aggregationData: state.compositeAggregations[props.componentId] || [],\n    hits: state.hits[props.componentId] && state.hits[props.componentId].hits || [],\n    rawData: state.rawData[props.componentId],\n    selectedValue: state.selectedValues[props.componentId] && state.selectedValues[props.componentId].value || null,\n    isLoading: state.isLoading[props.componentId],\n    error: state.error[props.componentId],\n    promotedResults: state.promotedResults[props.componentId] || [],\n    time: state.hits[props.componentId] && state.hits[props.componentId].time || 0,\n    total: state.hits[props.componentId] && state.hits[props.componentId].total,\n    hidden: state.hits[props.componentId] && state.hits[props.componentId].hidden\n  };\n};\n\nvar mapDispatchtoProps = function mapDispatchtoProps(dispatch) {\n  return {\n    setCustomQuery: function setCustomQuery(component, query) {\n      return dispatch((0, _actions.setCustomQuery)(component, query));\n    },\n    setDefaultQuery: function setDefaultQuery(component, query) {\n      return dispatch((0, _actions.setDefaultQuery)(component, query));\n    },\n    setQueryOptions: function setQueryOptions(component, props, execute) {\n      return dispatch((0, _actions.setQueryOptions)(component, props, execute));\n    },\n    updateQuery: function updateQuery(updateQueryObject) {\n      return dispatch((0, _actions.updateQuery)(updateQueryObject));\n    }\n  };\n};\n\nvar ConnectedComponent = (0, _utils.connect)(mapStateToProps, mapDispatchtoProps)(function (props) {\n  return _react2.default.createElement(_ComponentWrapper2.default, _extends({}, props, {\n    internalComponent: !!props.defaultQuery,\n    componentType: _constants.componentTypes.reactiveComponent\n  }), function () {\n    return _react2.default.createElement(ReactiveComponent, _extends({\n      ref: props.myForwardedRef\n    }, props));\n  });\n}); // eslint-disable-next-line\n\nvar ForwardRefComponent = _react2.default.forwardRef(function (props, ref) {\n  return _react2.default.createElement(ConnectedComponent, _extends({}, props, {\n    myForwardedRef: ref\n  }));\n});\n\nForwardRefComponent.name = 'ReactiveComponent';\nexports.default = ForwardRefComponent;","map":{"version":3,"sources":["/Users/rogetgeoffroy/Desktop/Folders/react_js_folder/react-live-search-app/live-search/node_modules/@appbaseio/reactivesearch/lib/components/basic/ReactiveComponent.js"],"names":["exports","__esModule","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","_react","require","_react2","_interopRequireDefault","_actions","_helper","_types","_types2","_transform","_constants","_utils","_ComponentWrapper","_ComponentWrapper2","obj","default","_objectWithoutProperties","keys","indexOf","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","value","setPrototypeOf","__proto__","ReactiveComponent","_Component","_this","getAggsQuery","aggregationField","getCompositeAggsQuery","internalComponent","defaultQuery","setQuery","data","console","error","options","setQueryOptions","componentId","queryToBeSet","query","customQuery","setCustomQuery","updateQuery","label","filterLabel","showFilter","URLParams","getInternalComponentID","updateCustomQuery","undefined","updateDefaultQuery","_ref","defaultQueryOptions","getOptionsFromQuery","componentDidMount","_props","selectedValue","defaultValue","initialValue","calcCustomQuery","_ref2","customQueryOptions","componentDidUpdate","prevProps","_this2","onData","checkSomePropChange","getData","checkPropChange","isEqual","_ref3","queryOptions","_ref4","_query","_queryOptions","_props2","hits","aggregations","aggregationData","promotedResults","rawData","filteredResults","parseHits","ids","map","item","_id","filter","Boolean","includes","concat","promotedData","resultStats","stats","getComponent","_props3","isLoading","loading","render","hasCustomRenderer","get","getResultStats","Component","defaultProps","size","propTypes","title","funcRequired","string","number","selectedValues","bool","children","func","stringRequired","any","onQueryChange","onError","react","componentType","componentTypes","reactiveComponent","mapStateToProps","state","compositeAggregations","time","total","hidden","mapDispatchtoProps","dispatch","component","setDefaultQuery","execute","updateQueryObject","ConnectedComponent","connect","createElement","ref","myForwardedRef","ForwardRefComponent","forwardRef","name"],"mappings":"AAAA;;AAEAA,OAAO,CAACC,UAAR,GAAqB,IAArB;;AAEA,IAAIC,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,UAAUC,MAAV,EAAkB;AAAE,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,QAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAtB;;AAA2B,SAAK,IAAII,GAAT,IAAgBD,MAAhB,EAAwB;AAAE,UAAIN,MAAM,CAACQ,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCJ,MAArC,EAA6CC,GAA7C,CAAJ,EAAuD;AAAEL,QAAAA,MAAM,CAACK,GAAD,CAAN,GAAcD,MAAM,CAACC,GAAD,CAApB;AAA4B;AAAE;AAAE;;AAAC,SAAOL,MAAP;AAAgB,CAAhQ;;AAEA,IAAIS,YAAY,GAAG,YAAY;AAAE,WAASC,gBAAT,CAA0BV,MAA1B,EAAkCW,KAAlC,EAAyC;AAAE,SAAK,IAAIV,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGU,KAAK,CAACR,MAA1B,EAAkCF,CAAC,EAAnC,EAAuC;AAAE,UAAIW,UAAU,GAAGD,KAAK,CAACV,CAAD,CAAtB;AAA2BW,MAAAA,UAAU,CAACC,UAAX,GAAwBD,UAAU,CAACC,UAAX,IAAyB,KAAjD;AAAwDD,MAAAA,UAAU,CAACE,YAAX,GAA0B,IAA1B;AAAgC,UAAI,WAAWF,UAAf,EAA2BA,UAAU,CAACG,QAAX,GAAsB,IAAtB;AAA4BjB,MAAAA,MAAM,CAACkB,cAAP,CAAsBhB,MAAtB,EAA8BY,UAAU,CAACP,GAAzC,EAA8CO,UAA9C;AAA4D;AAAE;;AAAC,SAAO,UAAUK,WAAV,EAAuBC,UAAvB,EAAmCC,WAAnC,EAAgD;AAAE,QAAID,UAAJ,EAAgBR,gBAAgB,CAACO,WAAW,CAACX,SAAb,EAAwBY,UAAxB,CAAhB;AAAqD,QAAIC,WAAJ,EAAiBT,gBAAgB,CAACO,WAAD,EAAcE,WAAd,CAAhB;AAA4C,WAAOF,WAAP;AAAqB,GAAhN;AAAmN,CAA9hB,EAAnB;;AAEA,IAAIG,MAAM,GAAGC,OAAO,CAAC,OAAD,CAApB;;AAEA,IAAIC,OAAO,GAAGC,sBAAsB,CAACH,MAAD,CAApC;;AAEA,IAAII,QAAQ,GAAGH,OAAO,CAAC,qCAAD,CAAtB;;AAEA,IAAII,OAAO,GAAGJ,OAAO,CAAC,0CAAD,CAArB;;AAEA,IAAIK,MAAM,GAAGL,OAAO,CAAC,yCAAD,CAApB;;AAEA,IAAIM,OAAO,GAAGJ,sBAAsB,CAACG,MAAD,CAApC;;AAEA,IAAIE,UAAU,GAAGP,OAAO,CAAC,6CAAD,CAAxB;;AAEA,IAAIQ,UAAU,GAAGR,OAAO,CAAC,6CAAD,CAAxB;;AAEA,IAAIS,MAAM,GAAGT,OAAO,CAAC,aAAD,CAApB;;AAEA,IAAIU,iBAAiB,GAAGV,OAAO,CAAC,2BAAD,CAA/B;;AAEA,IAAIW,kBAAkB,GAAGT,sBAAsB,CAACQ,iBAAD,CAA/C;;AAEA,SAASR,sBAAT,CAAgCU,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACrC,UAAX,GAAwBqC,GAAxB,GAA8B;AAAEC,IAAAA,OAAO,EAAED;AAAX,GAArC;AAAwD;;AAE/F,SAASE,wBAAT,CAAkCF,GAAlC,EAAuCG,IAAvC,EAA6C;AAAE,MAAIpC,MAAM,GAAG,EAAb;;AAAiB,OAAK,IAAIC,CAAT,IAAcgC,GAAd,EAAmB;AAAE,QAAIG,IAAI,CAACC,OAAL,CAAapC,CAAb,KAAmB,CAAvB,EAA0B;AAAU,QAAI,CAACH,MAAM,CAACQ,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCyB,GAArC,EAA0ChC,CAA1C,CAAL,EAAmD;AAAUD,IAAAA,MAAM,CAACC,CAAD,CAAN,GAAYgC,GAAG,CAAChC,CAAD,CAAf;AAAqB;;AAAC,SAAOD,MAAP;AAAgB;;AAE5N,SAASsC,eAAT,CAAyBC,QAAzB,EAAmCtB,WAAnC,EAAgD;AAAE,MAAI,EAAEsB,QAAQ,YAAYtB,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIuB,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,SAASC,0BAAT,CAAoCC,IAApC,EAA0ClC,IAA1C,EAAgD;AAAE,MAAI,CAACkC,IAAL,EAAW;AAAE,UAAM,IAAIC,cAAJ,CAAmB,2DAAnB,CAAN;AAAwF;;AAAC,SAAOnC,IAAI,KAAK,OAAOA,IAAP,KAAgB,QAAhB,IAA4B,OAAOA,IAAP,KAAgB,UAAjD,CAAJ,GAAmEA,IAAnE,GAA0EkC,IAAjF;AAAwF;;AAEhP,SAASE,SAAT,CAAmBC,QAAnB,EAA6BC,UAA7B,EAAyC;AAAE,MAAI,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,UAAU,KAAK,IAAvD,EAA6D;AAAE,UAAM,IAAIN,SAAJ,CAAc,6DAA6D,OAAOM,UAAlF,CAAN;AAAsG;;AAACD,EAAAA,QAAQ,CAACvC,SAAT,GAAqBR,MAAM,CAACiD,MAAP,CAAcD,UAAU,IAAIA,UAAU,CAACxC,SAAvC,EAAkD;AAAE0C,IAAAA,WAAW,EAAE;AAAEC,MAAAA,KAAK,EAAEJ,QAAT;AAAmBhC,MAAAA,UAAU,EAAE,KAA/B;AAAsCE,MAAAA,QAAQ,EAAE,IAAhD;AAAsDD,MAAAA,YAAY,EAAE;AAApE;AAAf,GAAlD,CAArB;AAAqK,MAAIgC,UAAJ,EAAgBhD,MAAM,CAACoD,cAAP,GAAwBpD,MAAM,CAACoD,cAAP,CAAsBL,QAAtB,EAAgCC,UAAhC,CAAxB,GAAsED,QAAQ,CAACM,SAAT,GAAqBL,UAA3F;AAAwG;;AAE9e,IAAIM,iBAAiB,GAAG,UAAUC,UAAV,EAAsB;AAC7CT,EAAAA,SAAS,CAACQ,iBAAD,EAAoBC,UAApB,CAAT;;AAEA,WAASD,iBAAT,CAA2BzC,KAA3B,EAAkC;AACjC2B,IAAAA,eAAe,CAAC,IAAD,EAAOc,iBAAP,CAAf;;AAEA,QAAIE,KAAK,GAAGb,0BAA0B,CAAC,IAAD,EAAOY,UAAU,CAAC7C,IAAX,CAAgB,IAAhB,EAAsBG,KAAtB,CAAP,CAAtC;;AAEA2C,IAAAA,KAAK,CAACC,YAAN,GAAqB,YAAY;AAChC,UAAID,KAAK,CAAC3C,KAAN,CAAY6C,gBAAhB,EAAkC;AACjC,eAAO,CAAC,GAAG/B,OAAO,CAACgC,qBAAZ,EAAmC,EAAnC,EAAuCH,KAAK,CAAC3C,KAA7C,EAAoD,IAApD,EAA0D,IAA1D,CAAP;AACA;;AACD,aAAO,EAAP;AACA,KALD;;AAOA2C,IAAAA,KAAK,CAACI,iBAAN,GAA0B,IAA1B;AACAJ,IAAAA,KAAK,CAACK,YAAN,GAAqB,IAArB;;AACAL,IAAAA,KAAK,CAACM,QAAN,GAAiB,UAAUC,IAAV,EAAgB;AAChC,UAAI,CAACA,IAAL,EAAW;AACVC,QAAAA,OAAO,CAACC,KAAR,CAAc,oEAAd;AACA;AACA;;AAED,UAAIC,OAAO,GAAGH,IAAI,CAACG,OAAnB;AAAA,UACI/B,GAAG,GAAGE,wBAAwB,CAAC0B,IAAD,EAAO,CAAC,SAAD,CAAP,CADlC;;AAGA,UAAIG,OAAJ,EAAa;AACZrD,QAAAA,KAAK,CAACsD,eAAN,CAAsBtD,KAAK,CAACuD,WAA5B,EAAyCrE,QAAQ,CAAC,EAAD,EAAKmE,OAAL,EAAcV,KAAK,CAACC,YAAN,EAAd,CAAjD,EAAsF,KAAtF;AACA;;AAED,UAAIY,YAAY,GAAGlC,GAAG,CAACmC,KAAvB,CAbgC,CAehC;;AACA,UAAInC,GAAG,IAAIA,GAAG,CAACmC,KAAX,IAAoBnC,GAAG,CAACmC,KAAJ,CAAUA,KAAlC,EAAyC;AACxCD,QAAAA,YAAY,GAAGlC,GAAG,CAACmC,KAAJ,CAAUA,KAAzB;AACA,OAlB+B,CAoBhC;;;AACA,UAAInC,GAAG,IAAIA,GAAG,CAACmC,KAAX,IAAoBJ,OAAxB,EAAiC;AAChC,YAAIK,WAAW,GAAGxE,QAAQ,CAAC,EAAD,EAAKmE,OAAL,CAA1B;;AACA,YAAI/B,GAAG,IAAIA,GAAG,CAACmC,KAAf,EAAsB;AACrBC,UAAAA,WAAW,CAACD,KAAZ,GAAoBD,YAApB;AACA;;AACDxD,QAAAA,KAAK,CAAC2D,cAAN,CAAqB3D,KAAK,CAACuD,WAA3B,EAAwCG,WAAxC;AACA;;AACDf,MAAAA,KAAK,CAAC3C,KAAN,CAAY4D,WAAZ,CAAwB1E,QAAQ,CAAC,EAAD,EAAKoC,GAAL,EAAU;AACzCmC,QAAAA,KAAK,EAAED,YADkC;AAEzCD,QAAAA,WAAW,EAAEvD,KAAK,CAACuD,WAFsB;AAGzCM,QAAAA,KAAK,EAAE7D,KAAK,CAAC8D,WAH4B;AAIzCC,QAAAA,UAAU,EAAE/D,KAAK,CAAC+D,UAJuB;AAKzCC,QAAAA,SAAS,EAAEhE,KAAK,CAACgE;AALwB,OAAV,CAAhC;AAOA,KAnCD;;AAqCA,QAAIhE,KAAK,CAACgD,YAAV,EAAwB;AACvBL,MAAAA,KAAK,CAACI,iBAAN,GAA0B,CAAC,GAAG9B,UAAU,CAACgD,sBAAf,EAAuCjE,KAAK,CAACuD,WAA7C,CAA1B;AACA,KArDgC,CAuDjC;;;AACA,KAAC,GAAGzC,OAAO,CAACoD,iBAAZ,EAA+BlE,KAAK,CAACuD,WAArC,EAAkDvD,KAAlD,EAAyDmE,SAAzD;AACA,KAAC,GAAGrD,OAAO,CAACsD,kBAAZ,EAAgCpE,KAAK,CAACuD,WAAtC,EAAmDvD,KAAnD,EAA0DmE,SAA1D;;AAEA,QAAIxB,KAAK,CAACI,iBAAN,IAA2B/C,KAAK,CAACgD,YAArC,EAAmD;AAClDL,MAAAA,KAAK,CAACK,YAAN,GAAqBhD,KAAK,CAACgD,YAAN,EAArB;;AAEA,UAAIqB,IAAI,GAAG1B,KAAK,CAACK,YAAN,IAAsB,EAAjC;AAAA,UACIS,KAAK,GAAGY,IAAI,CAACZ,KADjB;;AAGA,UAAIa,mBAAmB,GAAG3B,KAAK,CAACK,YAAN,GAAqB,CAAC,GAAGlC,OAAO,CAACyD,mBAAZ,EAAiC5B,KAAK,CAACK,YAAvC,CAArB,GAA4E,IAAtG;;AAEA,UAAIsB,mBAAJ,EAAyB;AACxBtE,QAAAA,KAAK,CAACsD,eAAN,CAAsBX,KAAK,CAACI,iBAA5B,EAA+C7D,QAAQ,CAAC,EAAD,EAAKoF,mBAAL,EAA0B3B,KAAK,CAACC,YAAN,EAA1B,CAAvD,EAAwG,KAAxG;AACA,OAFD,MAEOD,KAAK,CAAC3C,KAAN,CAAYsD,eAAZ,CAA4BX,KAAK,CAACI,iBAAlC,EAAqDJ,KAAK,CAACC,YAAN,EAArD;;AAEP5C,MAAAA,KAAK,CAAC4D,WAAN,CAAkB;AACjBL,QAAAA,WAAW,EAAEZ,KAAK,CAACI,iBADF;AAEjBU,QAAAA,KAAK,EAAEA,KAAK,IAAI;AAFC,OAAlB;AAIA;;AACD,WAAOd,KAAP;AACA;;AAEDF,EAAAA,iBAAiB,CAAC9C,SAAlB,CAA4B6E,iBAA5B,GAAgD,SAASA,iBAAT,GAA6B;AAC5E,QAAIC,MAAM,GAAG,KAAKzE,KAAlB;AAAA,QACI0D,WAAW,GAAGe,MAAM,CAACf,WADzB;AAAA,QAEIgB,aAAa,GAAGD,MAAM,CAACC,aAF3B;AAAA,QAGIpC,KAAK,GAAGmC,MAAM,CAACnC,KAHnB;AAAA,QAIIqC,YAAY,GAAGF,MAAM,CAACE,YAJ1B;AAAA,QAKIpB,WAAW,GAAGkB,MAAM,CAAClB,WALzB;AAAA,QAMIO,WAAW,GAAGW,MAAM,CAACX,WANzB;AAAA,QAOIC,UAAU,GAAGU,MAAM,CAACV,UAPxB;AAAA,QAQIC,SAAS,GAAGS,MAAM,CAACT,SARvB;AAUA,QAAIY,YAAY,GAAGF,aAAa,IAAIpC,KAAjB,IAA0BqC,YAA1B,IAA0C,IAA7D;;AAEA,QAAIjB,WAAJ,EAAiB;AAChB,UAAImB,eAAe,GAAGnB,WAAW,CAAC,KAAK1D,KAAN,CAAjC;;AAEA,UAAI8E,KAAK,GAAGD,eAAe,IAAI,EAA/B;AAAA,UACIpB,KAAK,GAAGqB,KAAK,CAACrB,KADlB;;AAGA,UAAIsB,kBAAkB,GAAGF,eAAe,GAAG,CAAC,GAAG/D,OAAO,CAACyD,mBAAZ,EAAiCM,eAAjC,CAAH,GAAuD,IAA/F;;AACA,UAAIE,kBAAJ,EAAwB;AACvB,aAAK/E,KAAL,CAAWsD,eAAX,CAA2BC,WAA3B,EAAwCrE,QAAQ,CAAC,EAAD,EAAK6F,kBAAL,EAAyB,KAAKnC,YAAL,EAAzB,CAAhD,EAA+F,KAA/F;AACA,OAFD,MAEO,KAAK5C,KAAL,CAAWsD,eAAX,CAA2BC,WAA3B,EAAwC,KAAKX,YAAL,EAAxC,EAA6D,KAA7D;;AACP,WAAK5C,KAAL,CAAW4D,WAAX,CAAuB;AACtBL,QAAAA,WAAW,EAAEA,WADS;AAEtBE,QAAAA,KAAK,EAAEA,KAFe;AAGtBnB,QAAAA,KAAK,EAAEsC,YAHe;AAItBf,QAAAA,KAAK,EAAEC,WAJe;AAKtBC,QAAAA,UAAU,EAAEA,UALU;AAMtBC,QAAAA,SAAS,EAAEA;AANW,OAAvB;AAQA;AACD,GAhCD;;AAkCAvB,EAAAA,iBAAiB,CAAC9C,SAAlB,CAA4BqF,kBAA5B,GAAiD,SAASA,kBAAT,CAA4BC,SAA5B,EAAuC;AACvF,QAAIC,MAAM,GAAG,IAAb,CADuF,CAGvF;;;AACA,QAAI,KAAKlF,KAAL,CAAWmF,MAAf,EAAuB;AACtB,OAAC,GAAGrE,OAAO,CAACsE,mBAAZ,EAAiC,KAAKpF,KAAtC,EAA6CiF,SAA7C,EAAwD,CAAC,MAAD,EAAS,cAAT,EAAyB,iBAAzB,EAA4C,OAA5C,EAAqD,MAArD,EAA6D,QAA7D,CAAxD,EAAgI,YAAY;AAC3IC,QAAAA,MAAM,CAAClF,KAAP,CAAamF,MAAb,CAAoBD,MAAM,CAACG,OAAP,EAApB;AACA,OAFD;AAGA;;AAED,KAAC,GAAGvE,OAAO,CAACwE,eAAZ,EAA6B,KAAKtF,KAAL,CAAW0E,aAAxC,EAAuDO,SAAS,CAACP,aAAjE,EAAgF,YAAY;AAC3F;;;AAIA,UAAIQ,MAAM,CAAClF,KAAP,CAAa0E,aAAb,KAA+B,IAAnC,EAAyC;AACxCQ,QAAAA,MAAM,CAAClF,KAAP,CAAa4D,WAAb,CAAyB;AACxBL,UAAAA,WAAW,EAAE2B,MAAM,CAAClF,KAAP,CAAauD,WADF;AAExBE,UAAAA,KAAK,EAAE;AAFiB,SAAzB;AAIA;AACD,KAXD;;AAaA,QAAI,KAAKzD,KAAL,CAAWgD,YAAX,IAA2B,CAAC,CAAC,GAAGlC,OAAO,CAACyE,OAAZ,EAAqB,KAAKvF,KAAL,CAAWgD,YAAX,EAArB,EAAgD,KAAKA,YAArD,CAAhC,EAAoG;AACnG,WAAKA,YAAL,GAAoB,KAAKhD,KAAL,CAAWgD,YAAX,EAApB;;AAEA,UAAIwC,KAAK,GAAG,KAAKxC,YAAL,IAAqB,EAAjC;AAAA,UACIS,KAAK,GAAG+B,KAAK,CAAC/B,KADlB;AAAA,UAEIgC,YAAY,GAAGjE,wBAAwB,CAACgE,KAAD,EAAQ,CAAC,OAAD,CAAR,CAF3C;;AAIA,UAAIC,YAAJ,EAAkB;AACjB,aAAKzF,KAAL,CAAWsD,eAAX,CAA2B,KAAKP,iBAAhC,EAAmD7D,QAAQ,CAAC,EAAD,EAAKuG,YAAL,EAAmB,KAAK7C,YAAL,EAAnB,CAA3D,EAAoG,KAApG;AACA,OAFD,MAEO,KAAK5C,KAAL,CAAWsD,eAAX,CAA2B,KAAKP,iBAAhC,EAAmD,KAAKH,YAAL,EAAnD,EAAwE,KAAxE;;AACP,OAAC,GAAG9B,OAAO,CAACsD,kBAAZ,EAAgC,KAAKpE,KAAL,CAAWuD,WAA3C,EAAwD,KAAKvD,KAA7D,EAAoEmE,SAApE;AACA,WAAKnE,KAAL,CAAW4D,WAAX,CAAuB;AACtBL,QAAAA,WAAW,EAAE,KAAKR,iBADI;AAEtBU,QAAAA,KAAK,EAAEA,KAAK,IAAI;AAFM,OAAvB;AAIA;;AAED,QAAI,KAAKzD,KAAL,CAAW0D,WAAX,IAA0B,CAAC,CAAC,GAAG5C,OAAO,CAACyE,OAAZ,EAAqB,KAAKvF,KAAL,CAAW0D,WAAX,CAAuB,KAAK1D,KAA5B,CAArB,EAAyDiF,SAAS,CAACvB,WAAV,CAAsB,KAAK1D,KAA3B,CAAzD,CAA/B,EAA4H;AAC3H,UAAI0F,KAAK,GAAG,KAAK1F,KAAL,CAAW0D,WAAX,CAAuB,KAAK1D,KAA5B,KAAsC,EAAlD;AAAA,UACI2F,MAAM,GAAGD,KAAK,CAACjC,KADnB;AAAA,UAEImC,aAAa,GAAGpE,wBAAwB,CAACkE,KAAD,EAAQ,CAAC,OAAD,CAAR,CAF5C;;AAIA,UAAIE,aAAJ,EAAmB;AAClB,aAAK5F,KAAL,CAAWsD,eAAX,CAA2B,KAAKtD,KAAL,CAAWuD,WAAtC,EAAmDrE,QAAQ,CAAC,EAAD,EAAK0G,aAAL,EAAoB,KAAKhD,YAAL,EAApB,CAA3D,EAAqG,KAArG;AACA,OAFD,MAEO,KAAK5C,KAAL,CAAWsD,eAAX,CAA2B,KAAKtD,KAAL,CAAWuD,WAAtC,EAAmD,KAAKX,YAAL,EAAnD,EAAwE,KAAxE;;AACP,OAAC,GAAG9B,OAAO,CAACoD,iBAAZ,EAA+B,KAAKlE,KAAL,CAAWuD,WAA1C,EAAuD,KAAKvD,KAA5D,EAAmEmE,SAAnE;AACA,WAAKnE,KAAL,CAAW4D,WAAX,CAAuB;AACtBL,QAAAA,WAAW,EAAE,KAAKvD,KAAL,CAAWuD,WADF;AAEtBE,QAAAA,KAAK,EAAEkC,MAAM,IAAI;AAFK,OAAvB;AAIA;AACD,GAtDD;;AAwDAlD,EAAAA,iBAAiB,CAAC9C,SAAlB,CAA4B0F,OAA5B,GAAsC,SAASA,OAAT,GAAmB;AACxD,QAAIQ,OAAO,GAAG,KAAK7F,KAAnB;AAAA,QACI8F,IAAI,GAAGD,OAAO,CAACC,IADnB;AAAA,QAEIC,YAAY,GAAGF,OAAO,CAACE,YAF3B;AAAA,QAGIC,eAAe,GAAGH,OAAO,CAACG,eAH9B;AAAA,QAIIC,eAAe,GAAGJ,OAAO,CAACI,eAJ9B;AAAA,QAKIC,OAAO,GAAGL,OAAO,CAACK,OALtB;AAOA,QAAIC,eAAe,GAAG,CAAC,GAAGrF,OAAO,CAACsF,SAAZ,EAAuBN,IAAvB,CAAtB;;AACA,QAAIG,eAAe,CAACzG,MAApB,EAA4B;AAC3B,UAAI6G,GAAG,GAAGJ,eAAe,CAACK,GAAhB,CAAoB,UAAUC,IAAV,EAAgB;AAC7C,eAAOA,IAAI,CAACC,GAAZ;AACA,OAFS,EAEPC,MAFO,CAEAC,OAFA,CAAV;;AAGA,UAAIL,GAAJ,EAAS;AACRF,QAAAA,eAAe,GAAGA,eAAe,CAACM,MAAhB,CAAuB,UAAUF,IAAV,EAAgB;AACxD,iBAAO,CAACF,GAAG,CAACM,QAAJ,CAAaJ,IAAI,CAACC,GAAlB,CAAR;AACA,SAFiB,CAAlB;AAGA;;AACDL,MAAAA,eAAe,GAAG,GAAGS,MAAH,CAAUX,eAAV,EAA2BE,eAA3B,CAAlB;AACA;;AACD,WAAO;AACNjD,MAAAA,IAAI,EAAEiD,eADA;AAENU,MAAAA,YAAY,EAAEZ,eAFR;AAGND,MAAAA,eAAe,EAAEA,eAAe,IAAI,EAH9B;AAINE,MAAAA,OAAO,EAAEA,OAJH;AAKNH,MAAAA,YAAY,EAAEA,YALR;AAMNe,MAAAA,WAAW,EAAE,KAAKC;AANZ,KAAP;AAQA,GA5BD;;AA8BAtE,EAAAA,iBAAiB,CAAC9C,SAAlB,CAA4BqH,YAA5B,GAA2C,SAASA,YAAT,GAAwB;AAClE,QAAIC,OAAO,GAAG,KAAKjH,KAAnB;AAAA,QACIoD,KAAK,GAAG6D,OAAO,CAAC7D,KADpB;AAAA,QAEI8D,SAAS,GAAGD,OAAO,CAACC,SAFxB;AAAA,QAGIxC,aAAa,GAAGuC,OAAO,CAACvC,aAH5B;;AAKA,QAAIxB,IAAI,GAAGhE,QAAQ,CAAC;AACnBkE,MAAAA,KAAK,EAAEA,KADY;AAEnB+D,MAAAA,OAAO,EAAED;AAFU,KAAD,EAGhB,KAAK7B,OAAL,EAHgB,EAGA;AAClB/C,MAAAA,KAAK,EAAEoC,aADW;AAElBzB,MAAAA,QAAQ,EAAE,KAAKA;AAFG,KAHA,CAAnB;;AAOA,WAAO,CAAC,GAAG9B,MAAM,CAAC6F,YAAX,EAAyB9D,IAAzB,EAA+B,KAAKlD,KAApC,CAAP;AACA,GAdD;;AAgBAyC,EAAAA,iBAAiB,CAAC9C,SAAlB,CAA4ByH,MAA5B,GAAqC,SAASA,MAAT,GAAkB;AACtD,QAAI,CAAC,GAAGjG,MAAM,CAACkG,iBAAX,EAA8B,KAAKrH,KAAnC,CAAJ,EAA+C;AAC9C,aAAO,KAAKgH,YAAL,EAAP;AACA;;AACD,WAAO,IAAP;AACA,GALD;;AAOAlH,EAAAA,YAAY,CAAC2C,iBAAD,EAAoB,CAAC;AAChC/C,IAAAA,GAAG,EAAE,OAD2B;AAEhC4H,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AACnB,aAAO,CAAC,GAAGxG,OAAO,CAACyG,cAAZ,EAA4B,KAAKvH,KAAjC,CAAP;AACA;AAJ+B,GAAD,CAApB,CAAZ;;AAOA,SAAOyC,iBAAP;AACA,CAzOuB,CAyOtBhC,MAAM,CAAC+G,SAzOe,CAAxB;;AA2OA/E,iBAAiB,CAACgF,YAAlB,GAAiC;AAChC1D,EAAAA,UAAU,EAAE,IADoB;AAEhCC,EAAAA,SAAS,EAAE,KAFqB;AAGhC0D,EAAAA,IAAI,EAAE;AAH0B,CAAjC;AAMAjF,iBAAiB,CAACkF,SAAlB,GAA8B;AAC7BvE,EAAAA,KAAK,EAAEpC,OAAO,CAACO,OAAR,CAAgBqG,KADM;AAE7BtE,EAAAA,eAAe,EAAEtC,OAAO,CAACO,OAAR,CAAgBsG,YAFJ;AAG7BjE,EAAAA,WAAW,EAAE5C,OAAO,CAACO,OAAR,CAAgBsG,YAHA;AAI7BhF,EAAAA,gBAAgB,EAAE7B,OAAO,CAACO,OAAR,CAAgBuG,MAJL;AAK7BJ,EAAAA,IAAI,EAAE1G,OAAO,CAACO,OAAR,CAAgBwG,MALO;AAM7BhC,EAAAA,YAAY,EAAE/E,OAAO,CAACO,OAAR,CAAgByG,cAND;AAO7BhC,EAAAA,eAAe,EAAEhF,OAAO,CAACO,OAAR,CAAgByE,eAPJ;AAQ7BF,EAAAA,IAAI,EAAE9E,OAAO,CAACO,OAAR,CAAgB2B,IARO;AAS7BgD,EAAAA,OAAO,EAAElF,OAAO,CAACO,OAAR,CAAgB2E,OATI;AAU7BD,EAAAA,eAAe,EAAEjF,OAAO,CAACO,OAAR,CAAgBuE,IAVJ;AAW7BoB,EAAAA,SAAS,EAAElG,OAAO,CAACO,OAAR,CAAgB0G,IAXE;AAY7BvD,EAAAA,aAAa,EAAE1D,OAAO,CAACO,OAAR,CAAgBmD,aAZF;AAa7Bf,EAAAA,cAAc,EAAE3C,OAAO,CAACO,OAAR,CAAgBsG,YAbH;AAc7B;AACAK,EAAAA,QAAQ,EAAElH,OAAO,CAACO,OAAR,CAAgB4G,IAfG;AAgB7B5E,EAAAA,WAAW,EAAEvC,OAAO,CAACO,OAAR,CAAgB6G,cAhBA;AAiB7BpF,EAAAA,YAAY,EAAEhC,OAAO,CAACO,OAAR,CAAgB4G,IAjBD;AAkB7BzE,EAAAA,WAAW,EAAE1C,OAAO,CAACO,OAAR,CAAgB4G,IAlBA;AAmB7BxD,EAAAA,YAAY,EAAE3D,OAAO,CAACO,OAAR,CAAgB8G,GAnBD;AAmBM;AACnC/F,EAAAA,KAAK,EAAEtB,OAAO,CAACO,OAAR,CAAgB8G,GApBM;AAoBD;AAC5BvE,EAAAA,WAAW,EAAE9C,OAAO,CAACO,OAAR,CAAgBuG,MArBA;AAsB7BQ,EAAAA,aAAa,EAAEtH,OAAO,CAACO,OAAR,CAAgB4G,IAtBF;AAuB7BI,EAAAA,OAAO,EAAEvH,OAAO,CAACO,OAAR,CAAgB4G,IAvBI;AAwB7BK,EAAAA,KAAK,EAAExH,OAAO,CAACO,OAAR,CAAgBiH,KAxBM;AAyB7BpB,EAAAA,MAAM,EAAEpG,OAAO,CAACO,OAAR,CAAgB4G,IAzBK;AA0B7BpE,EAAAA,UAAU,EAAE/C,OAAO,CAACO,OAAR,CAAgB0G,IA1BC;AA2B7BjE,EAAAA,SAAS,EAAEhD,OAAO,CAACO,OAAR,CAAgB0G,IA3BE;AA4B7B9C,EAAAA,MAAM,EAAEnE,OAAO,CAACO,OAAR,CAAgB4G;AA5BK,CAA9B,C,CA+BA;;AACA1F,iBAAiB,CAACgG,aAAlB,GAAkCvH,UAAU,CAACwH,cAAX,CAA0BC,iBAA5D;;AAEA,IAAIC,eAAe,GAAG,SAASA,eAAT,CAAyBC,KAAzB,EAAgC7I,KAAhC,EAAuC;AAC5D,SAAO;AACN+F,IAAAA,YAAY,EAAE8C,KAAK,CAAC9C,YAAN,CAAmB/F,KAAK,CAACuD,WAAzB,KAAyCsF,KAAK,CAAC9C,YAAN,CAAmB/F,KAAK,CAACuD,WAAzB,CAAzC,IAAkF,IAD1F;AAENyC,IAAAA,eAAe,EAAE6C,KAAK,CAACC,qBAAN,CAA4B9I,KAAK,CAACuD,WAAlC,KAAkD,EAF7D;AAGNuC,IAAAA,IAAI,EAAE+C,KAAK,CAAC/C,IAAN,CAAW9F,KAAK,CAACuD,WAAjB,KAAiCsF,KAAK,CAAC/C,IAAN,CAAW9F,KAAK,CAACuD,WAAjB,EAA8BuC,IAA/D,IAAuE,EAHvE;AAINI,IAAAA,OAAO,EAAE2C,KAAK,CAAC3C,OAAN,CAAclG,KAAK,CAACuD,WAApB,CAJH;AAKNmB,IAAAA,aAAa,EAAEmE,KAAK,CAACb,cAAN,CAAqBhI,KAAK,CAACuD,WAA3B,KAA2CsF,KAAK,CAACb,cAAN,CAAqBhI,KAAK,CAACuD,WAA3B,EAAwCjB,KAAnF,IAA4F,IALrG;AAMN4E,IAAAA,SAAS,EAAE2B,KAAK,CAAC3B,SAAN,CAAgBlH,KAAK,CAACuD,WAAtB,CANL;AAONH,IAAAA,KAAK,EAAEyF,KAAK,CAACzF,KAAN,CAAYpD,KAAK,CAACuD,WAAlB,CAPD;AAQN0C,IAAAA,eAAe,EAAE4C,KAAK,CAAC5C,eAAN,CAAsBjG,KAAK,CAACuD,WAA5B,KAA4C,EARvD;AASNwF,IAAAA,IAAI,EAAEF,KAAK,CAAC/C,IAAN,CAAW9F,KAAK,CAACuD,WAAjB,KAAiCsF,KAAK,CAAC/C,IAAN,CAAW9F,KAAK,CAACuD,WAAjB,EAA8BwF,IAA/D,IAAuE,CATvE;AAUNC,IAAAA,KAAK,EAAEH,KAAK,CAAC/C,IAAN,CAAW9F,KAAK,CAACuD,WAAjB,KAAiCsF,KAAK,CAAC/C,IAAN,CAAW9F,KAAK,CAACuD,WAAjB,EAA8ByF,KAVhE;AAWNC,IAAAA,MAAM,EAAEJ,KAAK,CAAC/C,IAAN,CAAW9F,KAAK,CAACuD,WAAjB,KAAiCsF,KAAK,CAAC/C,IAAN,CAAW9F,KAAK,CAACuD,WAAjB,EAA8B0F;AAXjE,GAAP;AAaA,CAdD;;AAgBA,IAAIC,kBAAkB,GAAG,SAASA,kBAAT,CAA4BC,QAA5B,EAAsC;AAC9D,SAAO;AACNxF,IAAAA,cAAc,EAAE,SAASA,cAAT,CAAwByF,SAAxB,EAAmC3F,KAAnC,EAA0C;AACzD,aAAO0F,QAAQ,CAAC,CAAC,GAAGtI,QAAQ,CAAC8C,cAAb,EAA6ByF,SAA7B,EAAwC3F,KAAxC,CAAD,CAAf;AACA,KAHK;AAIN4F,IAAAA,eAAe,EAAE,SAASA,eAAT,CAAyBD,SAAzB,EAAoC3F,KAApC,EAA2C;AAC3D,aAAO0F,QAAQ,CAAC,CAAC,GAAGtI,QAAQ,CAACwI,eAAb,EAA8BD,SAA9B,EAAyC3F,KAAzC,CAAD,CAAf;AACA,KANK;AAONH,IAAAA,eAAe,EAAE,SAASA,eAAT,CAAyB8F,SAAzB,EAAoCpJ,KAApC,EAA2CsJ,OAA3C,EAAoD;AACpE,aAAOH,QAAQ,CAAC,CAAC,GAAGtI,QAAQ,CAACyC,eAAb,EAA8B8F,SAA9B,EAAyCpJ,KAAzC,EAAgDsJ,OAAhD,CAAD,CAAf;AACA,KATK;AAUN1F,IAAAA,WAAW,EAAE,SAASA,WAAT,CAAqB2F,iBAArB,EAAwC;AACpD,aAAOJ,QAAQ,CAAC,CAAC,GAAGtI,QAAQ,CAAC+C,WAAb,EAA0B2F,iBAA1B,CAAD,CAAf;AACA;AAZK,GAAP;AAcA,CAfD;;AAiBA,IAAIC,kBAAkB,GAAG,CAAC,GAAGrI,MAAM,CAACsI,OAAX,EAAoBb,eAApB,EAAqCM,kBAArC,EAAyD,UAAUlJ,KAAV,EAAiB;AAClG,SAAOW,OAAO,CAACY,OAAR,CAAgBmI,aAAhB,CACNrI,kBAAkB,CAACE,OADb,EAENrC,QAAQ,CAAC,EAAD,EAAKc,KAAL,EAAY;AACnB+C,IAAAA,iBAAiB,EAAE,CAAC,CAAC/C,KAAK,CAACgD,YADR;AAEnByF,IAAAA,aAAa,EAAEvH,UAAU,CAACwH,cAAX,CAA0BC;AAFtB,GAAZ,CAFF,EAMN,YAAY;AACX,WAAOhI,OAAO,CAACY,OAAR,CAAgBmI,aAAhB,CAA8BjH,iBAA9B,EAAiDvD,QAAQ,CAAC;AAAEyK,MAAAA,GAAG,EAAE3J,KAAK,CAAC4J;AAAb,KAAD,EAAgC5J,KAAhC,CAAzD,CAAP;AACA,GARK,CAAP;AAUA,CAXwB,CAAzB,C,CAaA;;AACA,IAAI6J,mBAAmB,GAAGlJ,OAAO,CAACY,OAAR,CAAgBuI,UAAhB,CAA2B,UAAU9J,KAAV,EAAiB2J,GAAjB,EAAsB;AAC1E,SAAOhJ,OAAO,CAACY,OAAR,CAAgBmI,aAAhB,CAA8BF,kBAA9B,EAAkDtK,QAAQ,CAAC,EAAD,EAAKc,KAAL,EAAY;AAAE4J,IAAAA,cAAc,EAAED;AAAlB,GAAZ,CAA1D,CAAP;AACA,CAFyB,CAA1B;;AAIAE,mBAAmB,CAACE,IAApB,GAA2B,mBAA3B;AACA/K,OAAO,CAACuC,OAAR,GAAkBsI,mBAAlB","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _actions = require('@appbaseio/reactivecore/lib/actions');\n\nvar _helper = require('@appbaseio/reactivecore/lib/utils/helper');\n\nvar _types = require('@appbaseio/reactivecore/lib/utils/types');\n\nvar _types2 = _interopRequireDefault(_types);\n\nvar _transform = require('@appbaseio/reactivecore/lib/utils/transform');\n\nvar _constants = require('@appbaseio/reactivecore/lib/utils/constants');\n\nvar _utils = require('../../utils');\n\nvar _ComponentWrapper = require('../basic/ComponentWrapper');\n\nvar _ComponentWrapper2 = _interopRequireDefault(_ComponentWrapper);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ReactiveComponent = function (_Component) {\n\t_inherits(ReactiveComponent, _Component);\n\n\tfunction ReactiveComponent(props) {\n\t\t_classCallCheck(this, ReactiveComponent);\n\n\t\tvar _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n\t\t_this.getAggsQuery = function () {\n\t\t\tif (_this.props.aggregationField) {\n\t\t\t\treturn (0, _helper.getCompositeAggsQuery)({}, _this.props, null, true);\n\t\t\t}\n\t\t\treturn {};\n\t\t};\n\n\t\t_this.internalComponent = null;\n\t\t_this.defaultQuery = null;\n\t\t_this.setQuery = function (data) {\n\t\t\tif (!data) {\n\t\t\t\tconsole.error('setQuery accepts the arguments of shape { query, options, value }.');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar options = data.options,\n\t\t\t    obj = _objectWithoutProperties(data, ['options']);\n\n\t\t\tif (options) {\n\t\t\t\tprops.setQueryOptions(props.componentId, _extends({}, options, _this.getAggsQuery()), false);\n\t\t\t}\n\n\t\t\tvar queryToBeSet = obj.query;\n\n\t\t\t// when enableAppbase is true, Backend throws error because of repeated query in request body\n\t\t\tif (obj && obj.query && obj.query.query) {\n\t\t\t\tqueryToBeSet = obj.query.query;\n\t\t\t}\n\n\t\t\t// Update customQuery field for RS API\n\t\t\tif (obj && obj.query || options) {\n\t\t\t\tvar customQuery = _extends({}, options);\n\t\t\t\tif (obj && obj.query) {\n\t\t\t\t\tcustomQuery.query = queryToBeSet;\n\t\t\t\t}\n\t\t\t\tprops.setCustomQuery(props.componentId, customQuery);\n\t\t\t}\n\t\t\t_this.props.updateQuery(_extends({}, obj, {\n\t\t\t\tquery: queryToBeSet,\n\t\t\t\tcomponentId: props.componentId,\n\t\t\t\tlabel: props.filterLabel,\n\t\t\t\tshowFilter: props.showFilter,\n\t\t\t\tURLParams: props.URLParams\n\t\t\t}));\n\t\t};\n\n\t\tif (props.defaultQuery) {\n\t\t\t_this.internalComponent = (0, _transform.getInternalComponentID)(props.componentId);\n\t\t}\n\n\t\t// Set custom and default queries in store\n\t\t(0, _helper.updateCustomQuery)(props.componentId, props, undefined);\n\t\t(0, _helper.updateDefaultQuery)(props.componentId, props, undefined);\n\n\t\tif (_this.internalComponent && props.defaultQuery) {\n\t\t\t_this.defaultQuery = props.defaultQuery();\n\n\t\t\tvar _ref = _this.defaultQuery || {},\n\t\t\t    query = _ref.query;\n\n\t\t\tvar defaultQueryOptions = _this.defaultQuery ? (0, _helper.getOptionsFromQuery)(_this.defaultQuery) : null;\n\n\t\t\tif (defaultQueryOptions) {\n\t\t\t\tprops.setQueryOptions(_this.internalComponent, _extends({}, defaultQueryOptions, _this.getAggsQuery()), false);\n\t\t\t} else _this.props.setQueryOptions(_this.internalComponent, _this.getAggsQuery());\n\n\t\t\tprops.updateQuery({\n\t\t\t\tcomponentId: _this.internalComponent,\n\t\t\t\tquery: query || null\n\t\t\t});\n\t\t}\n\t\treturn _this;\n\t}\n\n\tReactiveComponent.prototype.componentDidMount = function componentDidMount() {\n\t\tvar _props = this.props,\n\t\t    customQuery = _props.customQuery,\n\t\t    selectedValue = _props.selectedValue,\n\t\t    value = _props.value,\n\t\t    defaultValue = _props.defaultValue,\n\t\t    componentId = _props.componentId,\n\t\t    filterLabel = _props.filterLabel,\n\t\t    showFilter = _props.showFilter,\n\t\t    URLParams = _props.URLParams;\n\n\t\tvar initialValue = selectedValue || value || defaultValue || null;\n\n\t\tif (customQuery) {\n\t\t\tvar calcCustomQuery = customQuery(this.props);\n\n\t\t\tvar _ref2 = calcCustomQuery || {},\n\t\t\t    query = _ref2.query;\n\n\t\t\tvar customQueryOptions = calcCustomQuery ? (0, _helper.getOptionsFromQuery)(calcCustomQuery) : null;\n\t\t\tif (customQueryOptions) {\n\t\t\t\tthis.props.setQueryOptions(componentId, _extends({}, customQueryOptions, this.getAggsQuery()), false);\n\t\t\t} else this.props.setQueryOptions(componentId, this.getAggsQuery(), false);\n\t\t\tthis.props.updateQuery({\n\t\t\t\tcomponentId: componentId,\n\t\t\t\tquery: query,\n\t\t\t\tvalue: initialValue,\n\t\t\t\tlabel: filterLabel,\n\t\t\t\tshowFilter: showFilter,\n\t\t\t\tURLParams: URLParams\n\t\t\t});\n\t\t}\n\t};\n\n\tReactiveComponent.prototype.componentDidUpdate = function componentDidUpdate(prevProps) {\n\t\tvar _this2 = this;\n\n\t\t// only consider hits and defaultQuery when customQuery is absent\n\t\tif (this.props.onData) {\n\t\t\t(0, _helper.checkSomePropChange)(this.props, prevProps, ['hits', 'aggregations', 'promotedResults', 'total', 'time', 'hidden'], function () {\n\t\t\t\t_this2.props.onData(_this2.getData());\n\t\t\t});\n\t\t}\n\n\t\t(0, _helper.checkPropChange)(this.props.selectedValue, prevProps.selectedValue, function () {\n\t\t\t/*\n   \tReset query when SelectedFilters are clicked. Note: `selectedValue` becomes null.\n   */\n\n\t\t\tif (_this2.props.selectedValue === null) {\n\t\t\t\t_this2.props.updateQuery({\n\t\t\t\t\tcomponentId: _this2.props.componentId,\n\t\t\t\t\tquery: null\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tif (this.props.defaultQuery && !(0, _helper.isEqual)(this.props.defaultQuery(), this.defaultQuery)) {\n\t\t\tthis.defaultQuery = this.props.defaultQuery();\n\n\t\t\tvar _ref3 = this.defaultQuery || {},\n\t\t\t    query = _ref3.query,\n\t\t\t    queryOptions = _objectWithoutProperties(_ref3, ['query']);\n\n\t\t\tif (queryOptions) {\n\t\t\t\tthis.props.setQueryOptions(this.internalComponent, _extends({}, queryOptions, this.getAggsQuery()), false);\n\t\t\t} else this.props.setQueryOptions(this.internalComponent, this.getAggsQuery(), false);\n\t\t\t(0, _helper.updateDefaultQuery)(this.props.componentId, this.props, undefined);\n\t\t\tthis.props.updateQuery({\n\t\t\t\tcomponentId: this.internalComponent,\n\t\t\t\tquery: query || null\n\t\t\t});\n\t\t}\n\n\t\tif (this.props.customQuery && !(0, _helper.isEqual)(this.props.customQuery(this.props), prevProps.customQuery(this.props))) {\n\t\t\tvar _ref4 = this.props.customQuery(this.props) || {},\n\t\t\t    _query = _ref4.query,\n\t\t\t    _queryOptions = _objectWithoutProperties(_ref4, ['query']);\n\n\t\t\tif (_queryOptions) {\n\t\t\t\tthis.props.setQueryOptions(this.props.componentId, _extends({}, _queryOptions, this.getAggsQuery()), false);\n\t\t\t} else this.props.setQueryOptions(this.props.componentId, this.getAggsQuery(), false);\n\t\t\t(0, _helper.updateCustomQuery)(this.props.componentId, this.props, undefined);\n\t\t\tthis.props.updateQuery({\n\t\t\t\tcomponentId: this.props.componentId,\n\t\t\t\tquery: _query || null\n\t\t\t});\n\t\t}\n\t};\n\n\tReactiveComponent.prototype.getData = function getData() {\n\t\tvar _props2 = this.props,\n\t\t    hits = _props2.hits,\n\t\t    aggregations = _props2.aggregations,\n\t\t    aggregationData = _props2.aggregationData,\n\t\t    promotedResults = _props2.promotedResults,\n\t\t    rawData = _props2.rawData;\n\n\t\tvar filteredResults = (0, _helper.parseHits)(hits);\n\t\tif (promotedResults.length) {\n\t\t\tvar ids = promotedResults.map(function (item) {\n\t\t\t\treturn item._id;\n\t\t\t}).filter(Boolean);\n\t\t\tif (ids) {\n\t\t\t\tfilteredResults = filteredResults.filter(function (item) {\n\t\t\t\t\treturn !ids.includes(item._id);\n\t\t\t\t});\n\t\t\t}\n\t\t\tfilteredResults = [].concat(promotedResults, filteredResults);\n\t\t}\n\t\treturn {\n\t\t\tdata: filteredResults,\n\t\t\tpromotedData: promotedResults,\n\t\t\taggregationData: aggregationData || [],\n\t\t\trawData: rawData,\n\t\t\taggregations: aggregations,\n\t\t\tresultStats: this.stats\n\t\t};\n\t};\n\n\tReactiveComponent.prototype.getComponent = function getComponent() {\n\t\tvar _props3 = this.props,\n\t\t    error = _props3.error,\n\t\t    isLoading = _props3.isLoading,\n\t\t    selectedValue = _props3.selectedValue;\n\n\t\tvar data = _extends({\n\t\t\terror: error,\n\t\t\tloading: isLoading\n\t\t}, this.getData(), {\n\t\t\tvalue: selectedValue,\n\t\t\tsetQuery: this.setQuery\n\t\t});\n\t\treturn (0, _utils.getComponent)(data, this.props);\n\t};\n\n\tReactiveComponent.prototype.render = function render() {\n\t\tif ((0, _utils.hasCustomRenderer)(this.props)) {\n\t\t\treturn this.getComponent();\n\t\t}\n\t\treturn null;\n\t};\n\n\t_createClass(ReactiveComponent, [{\n\t\tkey: 'stats',\n\t\tget: function get() {\n\t\t\treturn (0, _helper.getResultStats)(this.props);\n\t\t}\n\t}]);\n\n\treturn ReactiveComponent;\n}(_react.Component);\n\nReactiveComponent.defaultProps = {\n\tshowFilter: true,\n\tURLParams: false,\n\tsize: 20\n};\n\nReactiveComponent.propTypes = {\n\terror: _types2.default.title,\n\tsetQueryOptions: _types2.default.funcRequired,\n\tupdateQuery: _types2.default.funcRequired,\n\taggregationField: _types2.default.string,\n\tsize: _types2.default.number,\n\taggregations: _types2.default.selectedValues,\n\taggregationData: _types2.default.aggregationData,\n\thits: _types2.default.data,\n\trawData: _types2.default.rawData,\n\tpromotedResults: _types2.default.hits,\n\tisLoading: _types2.default.bool,\n\tselectedValue: _types2.default.selectedValue,\n\tsetCustomQuery: _types2.default.funcRequired,\n\t// component props\n\tchildren: _types2.default.func,\n\tcomponentId: _types2.default.stringRequired,\n\tdefaultQuery: _types2.default.func,\n\tcustomQuery: _types2.default.func,\n\tdefaultValue: _types2.default.any, // eslint-disable-line\n\tvalue: _types2.default.any, // eslint-disable-line\n\tfilterLabel: _types2.default.string,\n\tonQueryChange: _types2.default.func,\n\tonError: _types2.default.func,\n\treact: _types2.default.react,\n\trender: _types2.default.func,\n\tshowFilter: _types2.default.bool,\n\tURLParams: _types2.default.bool,\n\tonData: _types2.default.func\n};\n\n// Add componentType for SSR\nReactiveComponent.componentType = _constants.componentTypes.reactiveComponent;\n\nvar mapStateToProps = function mapStateToProps(state, props) {\n\treturn {\n\t\taggregations: state.aggregations[props.componentId] && state.aggregations[props.componentId] || null,\n\t\taggregationData: state.compositeAggregations[props.componentId] || [],\n\t\thits: state.hits[props.componentId] && state.hits[props.componentId].hits || [],\n\t\trawData: state.rawData[props.componentId],\n\t\tselectedValue: state.selectedValues[props.componentId] && state.selectedValues[props.componentId].value || null,\n\t\tisLoading: state.isLoading[props.componentId],\n\t\terror: state.error[props.componentId],\n\t\tpromotedResults: state.promotedResults[props.componentId] || [],\n\t\ttime: state.hits[props.componentId] && state.hits[props.componentId].time || 0,\n\t\ttotal: state.hits[props.componentId] && state.hits[props.componentId].total,\n\t\thidden: state.hits[props.componentId] && state.hits[props.componentId].hidden\n\t};\n};\n\nvar mapDispatchtoProps = function mapDispatchtoProps(dispatch) {\n\treturn {\n\t\tsetCustomQuery: function setCustomQuery(component, query) {\n\t\t\treturn dispatch((0, _actions.setCustomQuery)(component, query));\n\t\t},\n\t\tsetDefaultQuery: function setDefaultQuery(component, query) {\n\t\t\treturn dispatch((0, _actions.setDefaultQuery)(component, query));\n\t\t},\n\t\tsetQueryOptions: function setQueryOptions(component, props, execute) {\n\t\t\treturn dispatch((0, _actions.setQueryOptions)(component, props, execute));\n\t\t},\n\t\tupdateQuery: function updateQuery(updateQueryObject) {\n\t\t\treturn dispatch((0, _actions.updateQuery)(updateQueryObject));\n\t\t}\n\t};\n};\n\nvar ConnectedComponent = (0, _utils.connect)(mapStateToProps, mapDispatchtoProps)(function (props) {\n\treturn _react2.default.createElement(\n\t\t_ComponentWrapper2.default,\n\t\t_extends({}, props, {\n\t\t\tinternalComponent: !!props.defaultQuery,\n\t\t\tcomponentType: _constants.componentTypes.reactiveComponent\n\t\t}),\n\t\tfunction () {\n\t\t\treturn _react2.default.createElement(ReactiveComponent, _extends({ ref: props.myForwardedRef }, props));\n\t\t}\n\t);\n});\n\n// eslint-disable-next-line\nvar ForwardRefComponent = _react2.default.forwardRef(function (props, ref) {\n\treturn _react2.default.createElement(ConnectedComponent, _extends({}, props, { myForwardedRef: ref }));\n});\n\nForwardRefComponent.name = 'ReactiveComponent';\nexports.default = ForwardRefComponent;"]},"metadata":{},"sourceType":"script"}